<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Scroll Position Listener</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      .container {
        position: fixed;
        width: 100%;
        height: 100vh;
        overflow-y: auto; /* Enable vertical scrolling */
        overflow-x: hidden;
        background-color: black;
      }

      .section {
        width: 80%;
        height: 20000px;
        background-color: aqua;
        position: relative;
      }

      .image {
        width: 60%;
        position: sticky;
        top: 0;
        left: 0;
        opacity: 0;
        transition: opacity 0.3s ease-in-out;
      }

      .image.visible {
        opacity: 1;
      }

      /* Info panel to show scroll data */
      .info-panel {
        position: fixed;
        top: 20px;
        right: 20px;
        background: rgba(255, 255, 255, 0.9);
        padding: 15px;
        border-radius: 8px;
        font-family: Arial, sans-serif;
        font-size: 14px;
        z-index: 1000;
        min-width: 200px;
      }

      .info-item {
        margin-bottom: 5px;
      }

      .progress-bar {
        width: 100%;
        height: 10px;
        background: #ddd;
        border-radius: 5px;
        overflow: hidden;
        margin-top: 10px;
      }

      .progress-fill {
        height: 100%;
        background: #4caf50;
        transition: width 0.1s ease;
      }
    </style>
  </head>
  <body>
    <div class="container" id="container">
      <div class="section" id="section">
        <img src="./comic/comic-1.png" alt="Image 1" class="image" id="img1" />
        <img src="./comic/comic-2.png" alt="Image 2" class="image" id="img2" />
        <img src="./comic/comic-3.png" alt="Image 3" class="image" id="img3" />
        <img src="./comic/comic-4.png" alt="Image 4" class="image" id="img4" />
        <img src="./comic/comic-5.png" alt="Image 5" class="image" id="img5" />
      </div>
    </div>

    <!-- Info panel to display scroll data -->
    <div class="info-panel">
      <div class="info-item">
        <strong>Scroll Position:</strong> <span id="scrollTop">0</span>px
      </div>
      <div class="info-item">
        <strong>Scroll Percentage:</strong> <span id="scrollPercent">0</span>%
      </div>
      <div class="info-item">
        <strong>Section Height:</strong> <span id="sectionHeight">0</span>px
      </div>
      <div class="info-item">
        <strong>Container Height:</strong> <span id="containerHeight">0</span>px
      </div>
      <div class="info-item">
        <strong>Current Image:</strong> <span id="currentImage">None</span>
      </div>
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
    </div>

    <script>
      // Get DOM elements
      const container = document.getElementById("container");
      const section = document.getElementById("section");
      const scrollTopSpan = document.getElementById("scrollTop");
      const scrollPercentSpan = document.getElementById("scrollPercent");
      const sectionHeightSpan = document.getElementById("sectionHeight");
      const containerHeightSpan = document.getElementById("containerHeight");
      const currentImageSpan = document.getElementById("currentImage");
      const progressFill = document.getElementById("progressFill");

      // Get all images
      const images = document.querySelectorAll(".image");

      // Function to update scroll information
      function updateScrollInfo() {
        // Get scroll position
        const scrollTop = container.scrollTop;

        // Get dimensions
        const sectionHeight = section.offsetHeight;
        const containerHeight = container.clientHeight;
        const maxScroll = sectionHeight - containerHeight;

        // Calculate scroll percentage
        const scrollPercent =
          maxScroll > 0 ? ((scrollTop / maxScroll) * 100).toFixed(2) : 0;

        // Update display
        scrollTopSpan.textContent = Math.round(scrollTop);
        scrollPercentSpan.textContent = scrollPercent;
        sectionHeightSpan.textContent = sectionHeight;
        containerHeightSpan.textContent = containerHeight;
        progressFill.style.width = scrollPercent + "%";

        // Determine which image should be visible based on scroll position
        const imageIndex = Math.floor(scrollTop / (maxScroll / images.length));
        const currentImageIndex = Math.min(
          Math.max(imageIndex, 0),
          images.length - 1
        );

        // Show images progressively - appear when scrolling down, disappear when scrolling up
        images.forEach((img, index) => {
          if (index <= currentImageIndex) {
            img.classList.add("visible");
          } else {
            img.classList.remove("visible");
          }
        });

        // Update current image display
        if (currentImageIndex >= 0) {
          currentImageSpan.textContent = `Images 1-${currentImageIndex + 1} visible`;
        } else {
          currentImageSpan.textContent = "No images visible";
        }

        // Log scroll data to console (optional)
        console.log({
          scrollTop: scrollTop,
          scrollPercent: scrollPercent + "%",
          currentImage: currentImageIndex + 1,
          maxScroll: maxScroll,
        });
      }

      // Listen for scroll events on the container
      container.addEventListener("scroll", updateScrollInfo);

      // Listen for window resize to update dimensions
      window.addEventListener("resize", updateScrollInfo);

      // Initial update
      updateScrollInfo();

      // Optional: Listen for specific scroll thresholds
      container.addEventListener("scroll", function () {
        const scrollTop = container.scrollTop;
        const maxScroll = section.offsetHeight - container.clientHeight;
        const scrollPercent = (scrollTop / maxScroll) * 100;

        // Trigger events at specific scroll percentages
        if (scrollPercent >= 25 && scrollPercent < 26) {
          console.log("25% scrolled!");
        }
        if (scrollPercent >= 50 && scrollPercent < 51) {
          console.log("50% scrolled!");
        }
        if (scrollPercent >= 75 && scrollPercent < 76) {
          console.log("75% scrolled!");
        }
        if (scrollPercent >= 99) {
          console.log("Almost at the bottom!");
        }
      });

      // Example of throttled scroll listener (for performance)
      let ticking = false;

      function throttledScrollHandler() {
        if (!ticking) {
          requestAnimationFrame(function () {
            updateScrollInfo();
            ticking = false;
          });
          ticking = true;
        }
      }

      // You can replace the regular scroll listener with this throttled version
      // container.addEventListener('scroll', throttledScrollHandler);
    </script>
  </body>
</html>
